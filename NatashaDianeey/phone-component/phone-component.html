<link rel="import" href="../polymer/polymer-element.html">
<link rel="import" href="../paper-button/paper-button.html">
<link rel="import" href="../iron-icon/iron-icon.html">

<link rel="import" href="../battery-component/battery-component.html">
<link rel="import" href="../player-component/player-component.html">
<link rel="import" href="../plug-component/plug-component.html">


<dom-module id="phone-component">
  <template>
    <style>
      :host {
        display: block;
      }
      .phone {
        border: 1px solid #000;
        min-height: 80vh;
      }
      .header {
        height: 30%;
        border-bottom: 1px solid #000;
        display: flex;
        flex-direction: row;
      }
      .battery {
        width: 30%;
        background-color: red;
      }
      iron-icon {
      --iron-icon-height: 32px;
      --iron-icon-width: 32px;
      }
      .low-battery {
        background-color: red;
      }
      .stable-battery {
        background-color: orange;
      }
      .full-battery {
        background-color: greenyellow;
      }
    </style>

    <plug-component></plug-component>

    <div class="phone">

      <battery-component id="battery"></battery-component>
      <player-component on-player="playerDetail"></player-component>

    </div>

  </template>

  <script>
    /**
     * `phone-component`
     * 
     *
     * @customElement
     * @polymer
     * @demo demo/index.html
     */
    class PhoneComponent extends Polymer.Element {
      static get is() { return 'phone-component'; }

      static get properties() {
        return {
          // charging: {
          //   type: Boolean,
          //   value: false,
          //   reflectToAttribute: true,
          //   notify: true,
          //   observer: '_manageCharging'
          // },
          // batteryStatus: {
          //   type: Number,
          //   value: 50,
          //   observer: '_setClassOfBattery'
          // },
          // _isPlaying: {
          //   type: Boolean,
          //   value: false,
          //   observer: '_manageCharging'
          // }
        };
      }

      playerDetail(e) {
        this.$.battery.restBattery(e.detail);
      }

      // play() {  
      //   this.dispatchEvent(new CustomEvent('phone-playing'));
      //   this.set('_isPlaying', true);
      //   console.log('esta reproduciendo');
      //   const intervalTime = setInterval(() => {
      //     if (this.batteryStatus > 0) {
      //       this.set('batteryStatus', this.batteryStatus - 1);
      //     }
      //     localStorage.setItem('playing', `${intervalTime}`);
      //   }, 1000);
      // }

      // stop() {
      //   this.set('_isPlaying', false);
      //   clearInterval(localStorage.getItem('playing'));
      //   console.log('stop a la reproduccion');
      // }

      // connected() {
      //   this.dispatchEvent(new CustomEvent('phone-playing'));
      //   const intervalTime = setInterval(() => {
      //     if (this.batteryStatus > 0) {
      //     this.set('batteryStatus', this.batteryStatus + 1);
      //     }
      //     localStorage.setItem('playing', `${intervalTime}`);
      //   }, 1000);
      // }

      // disconnected() {
      //   this.dispatchEvent(new CustomEvent('phone-playing'));

      //   clearInterval(localStorage.getItem('playing'));
      // }

      // _setClassOfBattery() {
      //   let batteryStatusClass = '';
      //   if (this.batteryStatus < 20) {
      //     batteryStatusClass = 'low-battery';
      //   }
      //   if (this.batteryStatus >= 20 && this.batteryStatus <= 80) {
      //     batteryStatusClass = 'stable-battery';
      //   }
      //   if (this.batteryStatus > 80) {
      //     batteryStatusClass = 'full-battery';
      //   }
      //   this.$.battery.classList.remove('low-battery', 'stable-battery', 'full-battery');
      //   this.$.battery.classList.add(batteryStatusClass);
      // }

      // _manageCharging() {
      //   if (this.charging) {
      //     const intervalTime = setInterval(() => {
      //       if (this.batteryStatus < 100) {
      //         this.set('batteryStatus', this.batteryStatus + 1);
      //       }
      //     }, 1000);
      //     localStorage.setItem('charging', `${intervalTime}`);
      //   } else {
      //     clearInterval(localStorage.getItem('charging'));
      //   }
      // }
    }

    window.customElements.define(PhoneComponent.is, PhoneComponent);
  </script>
</dom-module>
